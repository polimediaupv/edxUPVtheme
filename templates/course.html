<%namespace name='static' file='static_content.html'/>
<%!
from django.utils.translation import ugettext as _
from django.core.urlresolvers import reverse
from courseware.courses import course_image_url, get_course_about_section
from django.utils.timezone import UTC
import pytz
from django.utils import timezone
import datetime
from datetime import datetime as dt
%>
<%page args="course" />
<article id="${course.id | h}" class="course">
<%
                  now = dt.now(UTC())
                  start = course.enrollment_start or dt.min.replace(tzinfo=pytz.UTC)
                  end = course.enrollment_end or dt.max.replace(tzinfo=pytz.UTC)

                  canenroll = False

                  if start < now < end:
                     canenroll = True
                  endif
%>
  %if course.end < timezone.now() and canenroll:
    <span class="status">${_("Archivado")}</span>
  %elif course.is_newish:
    <span class="status">${_("New")}</span>
  %endif
  %if course.display_org_with_default.lower() == "coursebuilder":
    <a href="http://${course.display_number_with_default}.upvx.es">
  %elif course.display_org_with_default.lower() == "edxorg" :
    %if '...' in course.id.to_deprecated_string():
         
            <a href="" courseid='${course.id.to_deprecated_string().replace('...','').replace("/","_")}' edxorg="https://www.edx.org/course/${course.display_number_with_default.replace('...','')}-upvalenciax-${course.location.run}" local="${reverse('about_course', args=[course.id.to_deprecated_string()])}" class="edxorglink">
    %else:
            <a href="" courseid='${course.id.to_deprecated_string().replace("/","_")}' edxorg="https://www.edx.org/course/${course.display_number_with_default}-upvalenciax-${course.location.run}" local="${reverse('about_course', args=[course.id.to_deprecated_string()])}" class="edxorglink">
    %endif

  %else:
    <a href="${reverse('about_course', args=[course.id.to_deprecated_string()])}">
  %endif
  <div class="inner-wrapper">
      <header class="course-preview">
        <hgroup>
          <h2>${get_course_about_section(course, 'title')}</h2>        
        </hgroup>
        <div class="info-link">&#x2794;</div>
      </header>
      <section class="info">
        <div class="cover-image">
          <img src="${course_image_url(course)}" alt="MOOC ${course.display_number_with_default | h} ${get_course_about_section(course, 'title')} Cover Image" />
        </div>
        <div class="desc">
          <p>${get_course_about_section(course, 'short_description')}</p>
        </div>
        <div class="bottom">
          <span class="university">${get_course_about_section(course, 'university')}</span>
          % if not course.start_date_is_still_default:
          <span class="start-date">${course.start_datetime_text()}</span>
          % endif
        </div>
      </section>
    </div>
    <div class="meta-info">
      <p class="university">${get_course_about_section(course, 'university')}</p>
    </div>
  </a>
</article>
